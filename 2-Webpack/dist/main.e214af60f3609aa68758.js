/******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "./src/storage.js":
/*!************************!*\
  !*** ./src/storage.js ***!
  \************************/
/***/ ((module) => {

var TODOList = 'TODO-List';

function start() {
  //set an empty map if not-existent
  if (localStorage.getItem(TODOList) == null) {
    var todoMap = JSON.stringify({});
    localStorage.setItem(TODOList, todoMap);
  }
}

function setItemToLocalstorage(id, title, content) {
  start();
  var item = {
    "title": title,
    "content": content
  };
  var todoListString = localStorage.getItem(TODOList);
  var todoMap = JSON.parse(todoListString); //inset item to todo map

  todoMap[id] = item;
  localStorage.setItem(TODOList, JSON.stringify(todoMap));
}

function removeItemFromLocalstorage(id) {
  start();
  var todoListString = localStorage.getItem(TODOList);
  var todoMap = JSON.parse(todoListString); //delete item to todo map

  delete todoMap[id];
  localStorage.setItem(TODOList, JSON.stringify(todoMap));
}

function getAllItemsFromStorage() {
  start();
  return JSON.parse(localStorage.getItem(TODOList));
}

function getItemFromLocalstorage(id) {
  start();
  var todoListString = localStorage.getItem(TODOList);
  var todoMap = JSON.parse(todoListString);
  return todoMap[key];
}

function clearItemsFromItemList() {
  localStorage.setItem(TODOList, {});
}

function clearItemListFromStorage() {
  localStorage.removeItem(TODOList);
}

module.exports = {
  'set': setItemToLocalstorage,
  'get': getItemFromLocalstorage,
  'getAll': getAllItemsFromStorage,
  'remove': removeItemFromLocalstorage,
  'clear': clearItemsFromItemList,
  'clearStorage': clearItemListFromStorage
};

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
var __webpack_exports__ = {};
// This entry need to be wrapped in an IIFE because it need to be isolated against other modules in the chunk.
(() => {
/*!**********************!*\
  !*** ./src/index.js ***!
  \**********************/
var storage = __webpack_require__(/*! ./storage.js */ "./src/storage.js");

var editedID = 0;
var editMode = false;

function getNewID() {
  return new Date().getTime().toString();
}

function addItem() {
  var title = getValue('title-input');

  if (title == '') {
    alert('cant add an item without a title');
    return;
  }

  if (editMode) {
    alert('cant add an item while in edit mode');
    return;
  }

  var content = getValue('content-input');
  var list = document.getElementById('list');
  var id = getNewID();
  storage.set(id, title, content);
  var itemElement = createTodoItemElement(id, title, content);
  list.appendChild(itemElement); // reset menu display

  clearMenu();
  setInnerText('apply-button', 'Add');
} // function setItemToLocalstorage(id, title, content){
//     const item = {
//         "title": title,
//         "content": content
//     }
//     const todoListString = localStorage.getItem('TODO-List')
//     const todoMap = JSON.parse(todoListString)
//     //inset item to todo map
//     todoMap[id]=item
//     localStorage.setItem('TODO-List',JSON.stringify(todoMap))
// }
// function removeItemFromLocalstorage(id){
//     const todoListString = localStorage.getItem('TODO-List')
//     const todoMap = JSON.parse(todoListString)
//     //delete item to todo map
//     delete todoMap[id]
//     localStorage.setItem('TODO-List',JSON.stringify(todoMap))
// }
// function sendItemToEdit(itemID){
//     editedID = itemID
//     const title = getInnerText(`title${itemID}`)
//     const content = getInnerText(`content${itemID}`)
//     setValue('title-input',title)
//     setValue('content-input',content)
//     editMode = true
//     document.getElementById('cancel-button').hidden = false
//     setInnerText('apply-button','Apply')
// }
// function deleteItem(itemID){
//     if(editMode){
//         alert('cant delete while in edit mode')
//         return
//     }
//     const item = document.getElementById(itemID)
//     const list = document.getElementById('list')
//     // remove from display
//     list.removeChild(item)
//     // remove from item storage
//     storage.removeItem(itemID)
// }


function cancelEdit() {
  clearMenu();
  editMode = false;
  setInnerText('apply-button', 'Add');
  document.getElementById('cancel-button').hidden = true;
  editedID = 0;
}

function clearMenu() {
  setValue('title-input', '');
  setValue('content-input', '');
}

function menuButtonClick() {
  if (!editMode) {
    // adding a new item
    addItem();
  } else {
    // editing an existing item
    if (getValue('title-input') == '') {
      alert('cant set an empty title');
      return;
    }

    var title = getValue('title-input');
    var content = getValue('content-input');
    setInnerText("title".concat(editedID), title);
    setInnerText("content".concat(editedID), content);
    storage.set(editedID, title, content);
    clearMenu();
    editMode = false;
    setInnerText('apply-button', 'Add');
    document.getElementById('cancel-button').hidden = true;
    editedID = 0;
  }
}

function addButton() {
  clearMenu();
  document.getElementById('title-input').focus();
}

function getValue(id) {
  return document.getElementById(id).value;
}

function setValue(id, value) {
  document.getElementById(id).value = value;
}

function getInnerText(id) {
  return document.getElementById(id).innerText;
}

function setInnerText(id, text) {
  document.getElementById(id).innerText = text;
}

function createTodoItemElement(itemID, title, content) {
  // ol todo-item
  var itemElement = document.createElement('ol');
  itemElement.className = 'todo-item';
  itemElement.id = itemID; // input checkbox

  var itemCheckboxElement = document.createElement('input');
  itemCheckboxElement.type = 'checkbox';
  itemCheckboxElement.className = 'item-checkbox'; // div todo-item-text

  var itemTextElement = createItemTextElement(itemID, title, content);
  var itemButtonsElement = createItemButtonsElement(itemID); // append checkbox, text and buttons to list-item

  itemElement.appendChild(itemCheckboxElement);
  itemElement.appendChild(itemTextElement);
  itemElement.appendChild(itemButtonsElement);
  return itemElement;
}

function createItemButtonsElement(itemID) {
  var itemButtonsElement = document.createElement('div');
  itemButtonsElement.className = 'todo-item-buttons'; // button edit

  var editButtonElement = document.createElement('button');
  editButtonElement.innerText = 'edit';
  editButtonElement.className = 'item-edit-button';

  editButtonElement.onclick = function () {
    // set menu to editing state
    editMode = true;
    editedID = itemID;
    document.getElementById('cancel-button').hidden = false;
    setInnerText('apply-button', 'Apply');
    var title = getInnerText("title".concat(itemID));
    var content = getInnerText("content".concat(itemID));
    setValue('title-input', title);
    setValue('content-input', content);
  }; // button delete


  var deleteButtonElement = document.createElement('button');
  deleteButtonElement.innerText = 'delete';
  deleteButtonElement.className = 'item-delete-button';

  deleteButtonElement.onclick = function () {
    if (editMode) {
      alert('cant delete while in edit mode');
      return;
    }

    var item = document.getElementById(itemID);
    var list = document.getElementById('list'); // remove from display

    list.removeChild(item); // remove from item storage

    storage.remove(itemID);
  }; // append the buttons to container


  itemButtonsElement.appendChild(editButtonElement);
  itemButtonsElement.appendChild(deleteButtonElement);
  return itemButtonsElement;
}

function createItemTextElement(itemID, title, content) {
  var itemTextElement = document.createElement('div');
  itemTextElement.className = 'todo-item-text'; // item title

  var titleElement = document.createElement('div');
  titleElement.innerText = title;
  titleElement.className = 'todo-item-title';
  titleElement.id = 'title' + itemID; // item content

  var contentElement = document.createElement('div');
  contentElement.innerText = content;
  contentElement.className = 'todo-item-content';
  contentElement.id = 'content' + itemID; // append text to parent container 

  itemTextElement.appendChild(titleElement);
  itemTextElement.appendChild(contentElement);
  return itemTextElement;
}

window.onload = function () {
  // attach functions to menu buttons
  document.getElementById('menu').addEventListener('keyup', function (event) {
    if (event.keyCode === 13) {
      document.getElementById('apply-button').click();
      document.getElementById('title-input').focus();
    }
  });
  document.getElementById('clear-button').onclick = clearMenu;
  document.getElementById('apply-button').onclick = menuButtonClick;
  document.getElementById('cancel-button').onclick = cancelEdit;
  document.getElementById('add-button').onclick = addButton;
  var todoMap = storage.getAll();
  var list = document.getElementById('list');

  for (var key in todoMap) {
    var item = todoMap[key];
    var title = item['title'];
    var content = item['content'];
    var itemElement = createTodoItemElement(key, title, content);
    list.appendChild(itemElement);
  }
};
})();

/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0MsY0FBVCxDQUF3QixhQUF4QixFQUF1Q1ksS0FBdkM7QUFDSDtBQUNKLEdBTEQ7QUFNQWIsRUFBQUEsUUFBUSxDQUFDQyxjQUFULENBQXdCLGNBQXhCLEVBQXdDMkIsT0FBeEMsR0FBa0R0QixTQUFsRDtBQUNBTixFQUFBQSxRQUFRLENBQUNDLGNBQVQsQ0FBd0IsY0FBeEIsRUFBd0MyQixPQUF4QyxHQUFrRGpCLGVBQWxEO0FBQ0FYLEVBQUFBLFFBQVEsQ0FBQ0MsY0FBVCxDQUF3QixlQUF4QixFQUF5QzJCLE9BQXpDLEdBQW1EcEIsVUFBbkQ7QUFDQVIsRUFBQUEsUUFBUSxDQUFDQyxjQUFULENBQXdCLFlBQXhCLEVBQXNDMkIsT0FBdEMsR0FBZ0RoQixTQUFoRDtBQUVBLE1BQU01QyxPQUFPLEdBQUdvQixPQUFPLENBQUNvRCxNQUFSLEVBQWhCO0FBQ0EsTUFBTXpDLElBQUksR0FBR0MsUUFBUSxDQUFDQyxjQUFULENBQXdCLE1BQXhCLENBQWI7O0FBQ0EsT0FBSyxJQUFNbkIsR0FBWCxJQUFrQmQsT0FBbEIsRUFBMkI7QUFDdkIsUUFBTVEsSUFBSSxHQUFHUixPQUFPLENBQUNjLEdBQUQsQ0FBcEI7QUFDQSxRQUFNUixLQUFLLEdBQUdFLElBQUksQ0FBQyxPQUFELENBQWxCO0FBQ0EsUUFBTUQsT0FBTyxHQUFHQyxJQUFJLENBQUMsU0FBRCxDQUFwQjtBQUNBLFFBQU0yQixXQUFXLEdBQUdDLHFCQUFxQixDQUFDdEIsR0FBRCxFQUFLUixLQUFMLEVBQVdDLE9BQVgsQ0FBekM7QUFDQXdCLElBQUFBLElBQUksQ0FBQ00sV0FBTCxDQUFpQkYsV0FBakI7QUFDSDtBQUNKLENBdEJELEMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8yLXdlYnBhY2svLi9zcmMvc3RvcmFnZS5qcyIsIndlYnBhY2s6Ly8yLXdlYnBhY2svd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vMi13ZWJwYWNrLy4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFRPRE9MaXN0ID0gJ1RPRE8tTGlzdCdcbmZ1bmN0aW9uIHN0YXJ0KCl7XG4gICAgLy9zZXQgYW4gZW1wdHkgbWFwIGlmIG5vdC1leGlzdGVudFxuICAgIGlmKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFRPRE9MaXN0KT09bnVsbCl7XG4gICAgICAgIGNvbnN0IHRvZG9NYXAgPSBKU09OLnN0cmluZ2lmeSh7fSlcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oVE9ET0xpc3QsdG9kb01hcClcbiAgICB9XG59XG5mdW5jdGlvbiBzZXRJdGVtVG9Mb2NhbHN0b3JhZ2UoaWQsIHRpdGxlLCBjb250ZW50KXtcbiAgICBzdGFydCgpXG4gICAgY29uc3QgaXRlbSA9IHtcbiAgICAgICAgXCJ0aXRsZVwiOiB0aXRsZSxcbiAgICAgICAgXCJjb250ZW50XCI6IGNvbnRlbnRcbiAgICB9XG4gICAgY29uc3QgdG9kb0xpc3RTdHJpbmcgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShUT0RPTGlzdClcbiAgICBjb25zdCB0b2RvTWFwID0gSlNPTi5wYXJzZSh0b2RvTGlzdFN0cmluZylcbiAgICAvL2luc2V0IGl0ZW0gdG8gdG9kbyBtYXBcbiAgICB0b2RvTWFwW2lkXT1pdGVtXG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oVE9ET0xpc3QsSlNPTi5zdHJpbmdpZnkodG9kb01hcCkpXG59XG5mdW5jdGlvbiByZW1vdmVJdGVtRnJvbUxvY2Fsc3RvcmFnZShpZCl7XG4gICAgc3RhcnQoKVxuICAgIGNvbnN0IHRvZG9MaXN0U3RyaW5nID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oVE9ET0xpc3QpXG4gICAgY29uc3QgdG9kb01hcCA9IEpTT04ucGFyc2UodG9kb0xpc3RTdHJpbmcpXG4gICAgLy9kZWxldGUgaXRlbSB0byB0b2RvIG1hcFxuICAgIGRlbGV0ZSB0b2RvTWFwW2lkXVxuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFRPRE9MaXN0LEpTT04uc3RyaW5naWZ5KHRvZG9NYXApKVxufVxuZnVuY3Rpb24gZ2V0QWxsSXRlbXNGcm9tU3RvcmFnZSgpe1xuICAgIHN0YXJ0KClcbiAgICByZXR1cm4gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShUT0RPTGlzdCkpXG59XG5mdW5jdGlvbiBnZXRJdGVtRnJvbUxvY2Fsc3RvcmFnZShpZCl7XG4gICAgc3RhcnQoKVxuICAgIGNvbnN0IHRvZG9MaXN0U3RyaW5nID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oVE9ET0xpc3QpXG4gICAgY29uc3QgdG9kb01hcCA9IEpTT04ucGFyc2UodG9kb0xpc3RTdHJpbmcpXG4gICAgcmV0dXJuIHRvZG9NYXBba2V5XVxufVxuZnVuY3Rpb24gY2xlYXJJdGVtc0Zyb21JdGVtTGlzdCgpe1xuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFRPRE9MaXN0LHt9KVxufVxuZnVuY3Rpb24gY2xlYXJJdGVtTGlzdEZyb21TdG9yYWdlKCl7XG4gICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oVE9ET0xpc3QpXG59XG5tb2R1bGUuZXhwb3J0cyA9e1xuICAgICdzZXQnOnNldEl0ZW1Ub0xvY2Fsc3RvcmFnZSxcbiAgICAnZ2V0JzpnZXRJdGVtRnJvbUxvY2Fsc3RvcmFnZSxcbiAgICAnZ2V0QWxsJzpnZXRBbGxJdGVtc0Zyb21TdG9yYWdlLFxuICAgICdyZW1vdmUnOnJlbW92ZUl0ZW1Gcm9tTG9jYWxzdG9yYWdlLFxuICAgICdjbGVhcic6IGNsZWFySXRlbXNGcm9tSXRlbUxpc3QsXG4gICAgJ2NsZWFyU3RvcmFnZSc6Y2xlYXJJdGVtTGlzdEZyb21TdG9yYWdlXG59IiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsImNvbnN0IHN0b3JhZ2UgPSByZXF1aXJlKCcuL3N0b3JhZ2UuanMnKVxubGV0IGVkaXRlZElEID0gMDtcbmxldCBlZGl0TW9kZSA9IGZhbHNlO1xuXG5mdW5jdGlvbiBnZXROZXdJRCgpe1xuICAgIHJldHVybiBuZXcgRGF0ZSgpLmdldFRpbWUoKS50b1N0cmluZygpXG59XG5mdW5jdGlvbiBhZGRJdGVtKCl7XG4gICAgY29uc3QgdGl0bGUgPSBnZXRWYWx1ZSgndGl0bGUtaW5wdXQnKVxuICAgIGlmICh0aXRsZSA9PSAnJyl7XG4gICAgICAgIGFsZXJ0KCdjYW50IGFkZCBhbiBpdGVtIHdpdGhvdXQgYSB0aXRsZScpXG4gICAgICAgIHJldHVyblxuICAgIH1cbiAgICBpZiAoZWRpdE1vZGUpe1xuICAgICAgICBhbGVydCgnY2FudCBhZGQgYW4gaXRlbSB3aGlsZSBpbiBlZGl0IG1vZGUnKVxuICAgICAgICByZXR1cm5cbiAgICB9XG4gICAgY29uc3QgY29udGVudCA9IGdldFZhbHVlKCdjb250ZW50LWlucHV0JylcbiAgICBjb25zdCBsaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xpc3QnKVxuICAgIGNvbnN0IGlkID0gZ2V0TmV3SUQoKVxuICAgIHN0b3JhZ2Uuc2V0KGlkLCB0aXRsZSxjb250ZW50KVxuICAgIGNvbnN0IGl0ZW1FbGVtZW50ID0gY3JlYXRlVG9kb0l0ZW1FbGVtZW50KGlkLHRpdGxlLGNvbnRlbnQpXG4gICAgbGlzdC5hcHBlbmRDaGlsZChpdGVtRWxlbWVudClcbiAgICAvLyByZXNldCBtZW51IGRpc3BsYXlcbiAgICBjbGVhck1lbnUoKVxuICAgIHNldElubmVyVGV4dCgnYXBwbHktYnV0dG9uJywnQWRkJylcbn1cbi8vIGZ1bmN0aW9uIHNldEl0ZW1Ub0xvY2Fsc3RvcmFnZShpZCwgdGl0bGUsIGNvbnRlbnQpe1xuLy8gICAgIGNvbnN0IGl0ZW0gPSB7XG4vLyAgICAgICAgIFwidGl0bGVcIjogdGl0bGUsXG4vLyAgICAgICAgIFwiY29udGVudFwiOiBjb250ZW50XG4vLyAgICAgfVxuLy8gICAgIGNvbnN0IHRvZG9MaXN0U3RyaW5nID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ1RPRE8tTGlzdCcpXG4vLyAgICAgY29uc3QgdG9kb01hcCA9IEpTT04ucGFyc2UodG9kb0xpc3RTdHJpbmcpXG4vLyAgICAgLy9pbnNldCBpdGVtIHRvIHRvZG8gbWFwXG4vLyAgICAgdG9kb01hcFtpZF09aXRlbVxuLy8gICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdUT0RPLUxpc3QnLEpTT04uc3RyaW5naWZ5KHRvZG9NYXApKVxuLy8gfVxuLy8gZnVuY3Rpb24gcmVtb3ZlSXRlbUZyb21Mb2NhbHN0b3JhZ2UoaWQpe1xuLy8gICAgIGNvbnN0IHRvZG9MaXN0U3RyaW5nID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ1RPRE8tTGlzdCcpXG4vLyAgICAgY29uc3QgdG9kb01hcCA9IEpTT04ucGFyc2UodG9kb0xpc3RTdHJpbmcpXG4vLyAgICAgLy9kZWxldGUgaXRlbSB0byB0b2RvIG1hcFxuLy8gICAgIGRlbGV0ZSB0b2RvTWFwW2lkXVxuLy8gICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdUT0RPLUxpc3QnLEpTT04uc3RyaW5naWZ5KHRvZG9NYXApKVxuLy8gfVxuLy8gZnVuY3Rpb24gc2VuZEl0ZW1Ub0VkaXQoaXRlbUlEKXtcbiAgICBcbi8vICAgICBlZGl0ZWRJRCA9IGl0ZW1JRFxuLy8gICAgIGNvbnN0IHRpdGxlID0gZ2V0SW5uZXJUZXh0KGB0aXRsZSR7aXRlbUlEfWApXG4vLyAgICAgY29uc3QgY29udGVudCA9IGdldElubmVyVGV4dChgY29udGVudCR7aXRlbUlEfWApXG4vLyAgICAgc2V0VmFsdWUoJ3RpdGxlLWlucHV0Jyx0aXRsZSlcbi8vICAgICBzZXRWYWx1ZSgnY29udGVudC1pbnB1dCcsY29udGVudClcbiAgICBcbi8vICAgICBlZGl0TW9kZSA9IHRydWVcbi8vICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FuY2VsLWJ1dHRvbicpLmhpZGRlbiA9IGZhbHNlXG4vLyAgICAgc2V0SW5uZXJUZXh0KCdhcHBseS1idXR0b24nLCdBcHBseScpXG4vLyB9XG5cbi8vIGZ1bmN0aW9uIGRlbGV0ZUl0ZW0oaXRlbUlEKXtcbi8vICAgICBpZihlZGl0TW9kZSl7XG4vLyAgICAgICAgIGFsZXJ0KCdjYW50IGRlbGV0ZSB3aGlsZSBpbiBlZGl0IG1vZGUnKVxuLy8gICAgICAgICByZXR1cm5cbi8vICAgICB9XG4vLyAgICAgY29uc3QgaXRlbSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGl0ZW1JRClcbi8vICAgICBjb25zdCBsaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xpc3QnKVxuLy8gICAgIC8vIHJlbW92ZSBmcm9tIGRpc3BsYXlcbi8vICAgICBsaXN0LnJlbW92ZUNoaWxkKGl0ZW0pXG4vLyAgICAgLy8gcmVtb3ZlIGZyb20gaXRlbSBzdG9yYWdlXG4vLyAgICAgc3RvcmFnZS5yZW1vdmVJdGVtKGl0ZW1JRClcbi8vIH1cblxuZnVuY3Rpb24gY2FuY2VsRWRpdCgpe1xuICAgIGNsZWFyTWVudSgpXG4gICAgZWRpdE1vZGUgPSBmYWxzZVxuICAgIHNldElubmVyVGV4dCgnYXBwbHktYnV0dG9uJywnQWRkJylcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FuY2VsLWJ1dHRvbicpLmhpZGRlbiA9IHRydWVcbiAgICBlZGl0ZWRJRCA9IDAgIFxufVxuXG5mdW5jdGlvbiBjbGVhck1lbnUoKXtcbiAgICBzZXRWYWx1ZSgndGl0bGUtaW5wdXQnLCcnKVxuICAgIHNldFZhbHVlKCdjb250ZW50LWlucHV0JywnJylcbn1cblxuZnVuY3Rpb24gbWVudUJ1dHRvbkNsaWNrKCl7XG4gICAgaWYoIWVkaXRNb2RlKXtcbiAgICAgICAgLy8gYWRkaW5nIGEgbmV3IGl0ZW1cbiAgICAgICAgYWRkSXRlbSgpXG4gICAgfWVsc2V7XG4gICAgICAgIC8vIGVkaXRpbmcgYW4gZXhpc3RpbmcgaXRlbVxuICAgICAgICBpZiAoZ2V0VmFsdWUoJ3RpdGxlLWlucHV0Jyk9PScnKXtcbiAgICAgICAgICAgIGFsZXJ0KCdjYW50IHNldCBhbiBlbXB0eSB0aXRsZScpXG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgfVxuICAgICAgICBjb25zdCB0aXRsZSA9IGdldFZhbHVlKCd0aXRsZS1pbnB1dCcpXG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSBnZXRWYWx1ZSgnY29udGVudC1pbnB1dCcpXG4gICAgICAgIHNldElubmVyVGV4dChgdGl0bGUke2VkaXRlZElEfWAsdGl0bGUpXG4gICAgICAgIHNldElubmVyVGV4dChgY29udGVudCR7ZWRpdGVkSUR9YCxjb250ZW50KVxuICAgICAgICBzdG9yYWdlLnNldChlZGl0ZWRJRCwgdGl0bGUsIGNvbnRlbnQpXG4gICAgICAgIGNsZWFyTWVudSgpXG4gICAgICAgIGVkaXRNb2RlID0gZmFsc2VcbiAgICAgICAgc2V0SW5uZXJUZXh0KCdhcHBseS1idXR0b24nLCdBZGQnKVxuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FuY2VsLWJ1dHRvbicpLmhpZGRlbiA9IHRydWVcbiAgICAgICAgZWRpdGVkSUQgPSAwXG4gICAgfVxufVxuZnVuY3Rpb24gYWRkQnV0dG9uKCl7XG4gICAgY2xlYXJNZW51KClcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGl0bGUtaW5wdXQnKS5mb2N1cygpXG59XG5mdW5jdGlvbiBnZXRWYWx1ZShpZCl7XG4gICAgcmV0dXJuIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKS52YWx1ZVxufVxuZnVuY3Rpb24gc2V0VmFsdWUoaWQsdmFsdWUpe1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKS52YWx1ZSA9IHZhbHVlXG59XG5mdW5jdGlvbiBnZXRJbm5lclRleHQoaWQpe1xuICAgIHJldHVybiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCkuaW5uZXJUZXh0XG59XG5mdW5jdGlvbiBzZXRJbm5lclRleHQoaWQsdGV4dCl7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpLmlubmVyVGV4dCA9IHRleHRcbn1cbmZ1bmN0aW9uIGNyZWF0ZVRvZG9JdGVtRWxlbWVudChpdGVtSUQsdGl0bGUsY29udGVudCl7XG4gICAgLy8gb2wgdG9kby1pdGVtXG4gICAgY29uc3QgaXRlbUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvbCcpXG4gICAgaXRlbUVsZW1lbnQuY2xhc3NOYW1lID0gJ3RvZG8taXRlbSdcbiAgICBpdGVtRWxlbWVudC5pZCA9IGl0ZW1JRDtcbiAgICAvLyBpbnB1dCBjaGVja2JveFxuICAgIGNvbnN0IGl0ZW1DaGVja2JveEVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpXG4gICAgaXRlbUNoZWNrYm94RWxlbWVudC50eXBlID0gJ2NoZWNrYm94J1xuICAgIGl0ZW1DaGVja2JveEVsZW1lbnQuY2xhc3NOYW1lID0gJ2l0ZW0tY2hlY2tib3gnXG4gICAgLy8gZGl2IHRvZG8taXRlbS10ZXh0XG4gICAgY29uc3QgaXRlbVRleHRFbGVtZW50ID0gY3JlYXRlSXRlbVRleHRFbGVtZW50KGl0ZW1JRCx0aXRsZSxjb250ZW50KVxuICAgIGNvbnN0IGl0ZW1CdXR0b25zRWxlbWVudCA9IGNyZWF0ZUl0ZW1CdXR0b25zRWxlbWVudChpdGVtSUQpXG4gICAgLy8gYXBwZW5kIGNoZWNrYm94LCB0ZXh0IGFuZCBidXR0b25zIHRvIGxpc3QtaXRlbVxuICAgIGl0ZW1FbGVtZW50LmFwcGVuZENoaWxkKGl0ZW1DaGVja2JveEVsZW1lbnQpXG4gICAgaXRlbUVsZW1lbnQuYXBwZW5kQ2hpbGQoaXRlbVRleHRFbGVtZW50KVxuICAgIGl0ZW1FbGVtZW50LmFwcGVuZENoaWxkKGl0ZW1CdXR0b25zRWxlbWVudClcblxuICAgIHJldHVybiBpdGVtRWxlbWVudFxufVxuZnVuY3Rpb24gY3JlYXRlSXRlbUJ1dHRvbnNFbGVtZW50KGl0ZW1JRCl7XG5cbiAgICBjb25zdCBpdGVtQnV0dG9uc0VsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIGl0ZW1CdXR0b25zRWxlbWVudC5jbGFzc05hbWUgPSAndG9kby1pdGVtLWJ1dHRvbnMnXG4gICAgLy8gYnV0dG9uIGVkaXRcbiAgICBjb25zdCBlZGl0QnV0dG9uRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpXG4gICAgZWRpdEJ1dHRvbkVsZW1lbnQuaW5uZXJUZXh0ID0gJ2VkaXQnXG4gICAgZWRpdEJ1dHRvbkVsZW1lbnQuY2xhc3NOYW1lID0gJ2l0ZW0tZWRpdC1idXR0b24nXG4gICAgZWRpdEJ1dHRvbkVsZW1lbnQub25jbGljayA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIC8vIHNldCBtZW51IHRvIGVkaXRpbmcgc3RhdGVcbiAgICAgICAgZWRpdE1vZGUgPSB0cnVlXG4gICAgICAgIGVkaXRlZElEID0gaXRlbUlEXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW5jZWwtYnV0dG9uJykuaGlkZGVuID0gZmFsc2VcbiAgICAgICAgc2V0SW5uZXJUZXh0KCdhcHBseS1idXR0b24nLCdBcHBseScpXG4gICAgICAgIGNvbnN0IHRpdGxlID0gZ2V0SW5uZXJUZXh0KGB0aXRsZSR7aXRlbUlEfWApXG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSBnZXRJbm5lclRleHQoYGNvbnRlbnQke2l0ZW1JRH1gKVxuICAgICAgICBzZXRWYWx1ZSgndGl0bGUtaW5wdXQnLHRpdGxlKVxuICAgICAgICBzZXRWYWx1ZSgnY29udGVudC1pbnB1dCcsY29udGVudClcbiAgICB9XG4gICAgLy8gYnV0dG9uIGRlbGV0ZVxuICAgIGNvbnN0IGRlbGV0ZUJ1dHRvbkVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKVxuICAgIGRlbGV0ZUJ1dHRvbkVsZW1lbnQuaW5uZXJUZXh0ID0gJ2RlbGV0ZSdcbiAgICBkZWxldGVCdXR0b25FbGVtZW50LmNsYXNzTmFtZSA9ICdpdGVtLWRlbGV0ZS1idXR0b24nXG4gICAgZGVsZXRlQnV0dG9uRWxlbWVudC5vbmNsaWNrID0gZnVuY3Rpb24oKXtcbiAgICAgICAgaWYoZWRpdE1vZGUpe1xuICAgICAgICAgICAgYWxlcnQoJ2NhbnQgZGVsZXRlIHdoaWxlIGluIGVkaXQgbW9kZScpXG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgfVxuICAgICAgICBjb25zdCBpdGVtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaXRlbUlEKVxuICAgICAgICBjb25zdCBsaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xpc3QnKVxuICAgICAgICAvLyByZW1vdmUgZnJvbSBkaXNwbGF5XG4gICAgICAgIGxpc3QucmVtb3ZlQ2hpbGQoaXRlbSlcbiAgICAgICAgLy8gcmVtb3ZlIGZyb20gaXRlbSBzdG9yYWdlXG4gICAgICAgIHN0b3JhZ2UucmVtb3ZlKGl0ZW1JRClcbiAgICB9XG4gICAgLy8gYXBwZW5kIHRoZSBidXR0b25zIHRvIGNvbnRhaW5lclxuICAgIGl0ZW1CdXR0b25zRWxlbWVudC5hcHBlbmRDaGlsZChlZGl0QnV0dG9uRWxlbWVudClcbiAgICBpdGVtQnV0dG9uc0VsZW1lbnQuYXBwZW5kQ2hpbGQoZGVsZXRlQnV0dG9uRWxlbWVudClcblxuICAgIHJldHVybiBpdGVtQnV0dG9uc0VsZW1lbnRcbn1cbmZ1bmN0aW9uIGNyZWF0ZUl0ZW1UZXh0RWxlbWVudChpdGVtSUQsdGl0bGUsY29udGVudCl7XG5cbiAgICBjb25zdCBpdGVtVGV4dEVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIGl0ZW1UZXh0RWxlbWVudC5jbGFzc05hbWUgPSAndG9kby1pdGVtLXRleHQnXG4gICAgLy8gaXRlbSB0aXRsZVxuICAgIGNvbnN0IHRpdGxlRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgdGl0bGVFbGVtZW50LmlubmVyVGV4dCA9IHRpdGxlXG4gICAgdGl0bGVFbGVtZW50LmNsYXNzTmFtZSA9ICd0b2RvLWl0ZW0tdGl0bGUnXG4gICAgdGl0bGVFbGVtZW50LmlkID0gJ3RpdGxlJytpdGVtSURcbiAgICAvLyBpdGVtIGNvbnRlbnRcbiAgICBjb25zdCBjb250ZW50RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgY29udGVudEVsZW1lbnQuaW5uZXJUZXh0ID0gY29udGVudFxuICAgIGNvbnRlbnRFbGVtZW50LmNsYXNzTmFtZSA9ICd0b2RvLWl0ZW0tY29udGVudCdcbiAgICBjb250ZW50RWxlbWVudC5pZCA9ICdjb250ZW50JytpdGVtSURcbiAgICAvLyBhcHBlbmQgdGV4dCB0byBwYXJlbnQgY29udGFpbmVyIFxuICAgIGl0ZW1UZXh0RWxlbWVudC5hcHBlbmRDaGlsZCh0aXRsZUVsZW1lbnQpXG4gICAgaXRlbVRleHRFbGVtZW50LmFwcGVuZENoaWxkKGNvbnRlbnRFbGVtZW50KVxuXG4gICAgcmV0dXJuIGl0ZW1UZXh0RWxlbWVudFxufVxuXG53aW5kb3cub25sb2FkID0gZnVuY3Rpb24oKXtcbiAgICAvLyBhdHRhY2ggZnVuY3Rpb25zIHRvIG1lbnUgYnV0dG9uc1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtZW51JykuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICBpZiAoZXZlbnQua2V5Q29kZSA9PT0gMTMpIHtcbiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhcHBseS1idXR0b24nKS5jbGljaygpXG4gICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGl0bGUtaW5wdXQnKS5mb2N1cygpXG4gICAgICAgIH1cbiAgICB9KVxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjbGVhci1idXR0b24nKS5vbmNsaWNrID0gY2xlYXJNZW51XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FwcGx5LWJ1dHRvbicpLm9uY2xpY2sgPSBtZW51QnV0dG9uQ2xpY2tcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FuY2VsLWJ1dHRvbicpLm9uY2xpY2sgPSBjYW5jZWxFZGl0XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FkZC1idXR0b24nKS5vbmNsaWNrID0gYWRkQnV0dG9uXG5cbiAgICBjb25zdCB0b2RvTWFwID0gc3RvcmFnZS5nZXRBbGwoKVxuICAgIGNvbnN0IGxpc3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGlzdCcpXG4gICAgZm9yIChjb25zdCBrZXkgaW4gdG9kb01hcCkge1xuICAgICAgICBjb25zdCBpdGVtID0gdG9kb01hcFtrZXldXG4gICAgICAgIGNvbnN0IHRpdGxlID0gaXRlbVsndGl0bGUnXVxuICAgICAgICBjb25zdCBjb250ZW50ID0gaXRlbVsnY29udGVudCddXG4gICAgICAgIGNvbnN0IGl0ZW1FbGVtZW50ID0gY3JlYXRlVG9kb0l0ZW1FbGVtZW50KGtleSx0aXRsZSxjb250ZW50KVxuICAgICAgICBsaXN0LmFwcGVuZENoaWxkKGl0ZW1FbGVtZW50KVxuICAgIH1cbn1cbiJdLCJuYW1lcyI6WyJUT0RPTGlzdCIsInN0YXJ0IiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsInRvZG9NYXAiLCJKU09OIiwic3RyaW5naWZ5Iiwic2V0SXRlbSIsInNldEl0ZW1Ub0xvY2Fsc3RvcmFnZSIsImlkIiwidGl0bGUiLCJjb250ZW50IiwiaXRlbSIsInRvZG9MaXN0U3RyaW5nIiwicGFyc2UiLCJyZW1vdmVJdGVtRnJvbUxvY2Fsc3RvcmFnZSIsImdldEFsbEl0ZW1zRnJvbVN0b3JhZ2UiLCJnZXRJdGVtRnJvbUxvY2Fsc3RvcmFnZSIsImtleSIsImNsZWFySXRlbXNGcm9tSXRlbUxpc3QiLCJjbGVhckl0ZW1MaXN0RnJvbVN0b3JhZ2UiLCJyZW1vdmVJdGVtIiwibW9kdWxlIiwiZXhwb3J0cyIsInN0b3JhZ2UiLCJyZXF1aXJlIiwiZWRpdGVkSUQiLCJlZGl0TW9kZSIsImdldE5ld0lEIiwiRGF0ZSIsImdldFRpbWUiLCJ0b1N0cmluZyIsImFkZEl0ZW0iLCJnZXRWYWx1ZSIsImFsZXJ0IiwibGlzdCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJzZXQiLCJpdGVtRWxlbWVudCIsImNyZWF0ZVRvZG9JdGVtRWxlbWVudCIsImFwcGVuZENoaWxkIiwiY2xlYXJNZW51Iiwic2V0SW5uZXJUZXh0IiwiY2FuY2VsRWRpdCIsImhpZGRlbiIsInNldFZhbHVlIiwibWVudUJ1dHRvbkNsaWNrIiwiYWRkQnV0dG9uIiwiZm9jdXMiLCJ2YWx1ZSIsImdldElubmVyVGV4dCIsImlubmVyVGV4dCIsInRleHQiLCJpdGVtSUQiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NOYW1lIiwiaXRlbUNoZWNrYm94RWxlbWVudCIsInR5cGUiLCJpdGVtVGV4dEVsZW1lbnQiLCJjcmVhdGVJdGVtVGV4dEVsZW1lbnQiLCJpdGVtQnV0dG9uc0VsZW1lbnQiLCJjcmVhdGVJdGVtQnV0dG9uc0VsZW1lbnQiLCJlZGl0QnV0dG9uRWxlbWVudCIsIm9uY2xpY2siLCJkZWxldGVCdXR0b25FbGVtZW50IiwicmVtb3ZlQ2hpbGQiLCJyZW1vdmUiLCJ0aXRsZUVsZW1lbnQiLCJjb250ZW50RWxlbWVudCIsIndpbmRvdyIsIm9ubG9hZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsImtleUNvZGUiLCJjbGljayIsImdldEFsbCJdLCJzb3VyY2VSb290IjoiIn0=