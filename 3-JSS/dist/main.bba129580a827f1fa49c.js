/******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "./src/modules/helper-functions.js":
/*!*****************************************!*\
  !*** ./src/modules/helper-functions.js ***!
  \*****************************************/
/***/ ((module) => {

function getValue(id) {
  return document.getElementById(id).value;
}

function setValue(id, value) {
  document.getElementById(id).value = value;
}

function getInnerText(id) {
  return document.getElementById(id).innerText;
}

function setInnerText(id, text) {
  document.getElementById(id).innerText = text;
}

module.exports = {
  'getValue': getValue,
  'setValue': setValue,
  'getInnerText': getInnerText,
  'setInnerText': setInnerText
};

/***/ }),

/***/ "./src/modules/storage.js":
/*!********************************!*\
  !*** ./src/modules/storage.js ***!
  \********************************/
/***/ ((module) => {

var TODOList = 'TODO-List';

function start() {
  //set an empty map if not-existent
  if (localStorage.getItem(TODOList) == null) {
    var todoMap = JSON.stringify({});
    localStorage.setItem(TODOList, todoMap);
  }
}

function setItemToLocalstorage(id, title, content) {
  start();
  var item = {
    "title": title,
    "content": content
  };
  var todoListString = localStorage.getItem(TODOList);
  var todoMap = JSON.parse(todoListString); //inset item to todo map

  todoMap[id] = item;
  localStorage.setItem(TODOList, JSON.stringify(todoMap));
}

function removeItemFromLocalstorage(id) {
  start();
  var todoListString = localStorage.getItem(TODOList);
  var todoMap = JSON.parse(todoListString); //delete item to todo map

  delete todoMap[id];
  localStorage.setItem(TODOList, JSON.stringify(todoMap));
}

function getAllItemsFromStorage() {
  start();
  return JSON.parse(localStorage.getItem(TODOList));
}

function getItemFromLocalstorage(id) {
  start();
  var todoListString = localStorage.getItem(TODOList);
  var todoMap = JSON.parse(todoListString);
  return todoMap[key];
}

function clearItemsFromItemList() {
  localStorage.setItem(TODOList, {});
}

function clearTODOListFromStorage() {
  localStorage.removeItem(TODOList);
}

module.exports = {
  'set': setItemToLocalstorage,
  'get': getItemFromLocalstorage,
  'getAll': getAllItemsFromStorage,
  'remove': removeItemFromLocalstorage,
  'clear': clearItemsFromItemList,
  'clearStorage': clearTODOListFromStorage
};

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
var __webpack_exports__ = {};
// This entry need to be wrapped in an IIFE because it need to be isolated against other modules in the chunk.
(() => {
/*!**********************!*\
  !*** ./src/index.js ***!
  \**********************/
var storage = __webpack_require__(/*! ./modules/storage.js */ "./src/modules/storage.js");

var _require = __webpack_require__(/*! ./modules/helper-functions.js */ "./src/modules/helper-functions.js"),
    getValue = _require.getValue,
    setValue = _require.setValue,
    getInnerText = _require.getInnerText,
    setInnerText = _require.setInnerText;

var editedID = 0;
var editMode = false;

function getNewID() {
  return new Date().getTime().toString();
}

function addItem() {
  var title = getValue('title-input');

  if (title == '') {
    alert('cant add an item without a title');
    return;
  }

  if (editMode) {
    alert('cant add an item while in edit mode');
    return;
  }

  var content = getValue('content-input');
  var list = document.getElementById('list');
  var id = getNewID();
  storage.set(id, title, content);
  var itemElement = createTodoItemElement(id, title, content);
  list.appendChild(itemElement); // reset menu display

  clearMenu();
  setInnerText('apply-button', 'Add');
}

function deleteCheckedItems() {
  var itemList = storage.getAll();
  var list = document.getElementById('list');

  for (var id in itemList) {
    var checkbox = document.getElementById("item-checkbox".concat(id));

    if (checkbox.checked) {
      console.log(id, 'is checked');
      var itemElement = document.getElementById("".concat(id));
      list.removeChild(itemElement);
      storage.remove(id);
    }
  }
}

function cancelEdit() {
  clearMenu();
  editMode = false;
  setInnerText('apply-button', 'Add');
  document.getElementById('cancel-button').hidden = true;
  editedID = 0;
}

function clearMenu() {
  setValue('title-input', '');
  setValue('content-input', '');
}

function menuButtonClick() {
  if (!editMode) {
    // adding a new item
    addItem();
  } else {
    // editing an existing item
    if (getValue('title-input') == '') {
      alert('cant set an empty title');
      return;
    }

    var title = getValue('title-input');
    var content = getValue('content-input');
    setInnerText("title".concat(editedID), title);
    setInnerText("content".concat(editedID), content);
    storage.set(editedID, title, content);
    clearMenu();
    editMode = false;
    setInnerText('apply-button', 'Add');
    document.getElementById('cancel-button').hidden = true;
    editedID = 0;
  }
}

function addButton() {
  clearMenu();
  document.getElementById('title-input').focus();
}

function createTodoItemElement(itemID, title, content) {
  // ol todo-item
  var itemElement = document.createElement('ol');
  itemElement.className = 'todo-item';
  itemElement.id = itemID; // input checkbox

  var itemCheckboxElement = document.createElement('input');
  itemCheckboxElement.type = 'checkbox';
  itemCheckboxElement.className = 'item-checkbox';
  itemCheckboxElement.id = "item-checkbox".concat(itemID); // div todo-item-text

  var itemTextElement = createItemTextElement(itemID, title, content);
  var itemButtonsElement = createItemButtonsElement(itemID); // append checkbox, text and buttons to list-item

  itemElement.appendChild(itemCheckboxElement);
  itemElement.appendChild(itemTextElement);
  itemElement.appendChild(itemButtonsElement);
  return itemElement;
}

function createItemButtonsElement(itemID) {
  var itemButtonsElement = document.createElement('div');
  itemButtonsElement.className = 'todo-item-buttons'; // button edit

  var editButtonElement = document.createElement('button');
  editButtonElement.innerText = 'edit';
  editButtonElement.className = 'item-edit-button';

  editButtonElement.onclick = function () {
    // set menu to editing state
    editMode = true;
    editedID = itemID;
    document.getElementById('cancel-button').hidden = false;
    setInnerText('apply-button', 'Apply');
    var title = getInnerText("title".concat(itemID));
    var content = getInnerText("content".concat(itemID));
    setValue('title-input', title);
    setValue('content-input', content);
  }; // button delete


  var deleteButtonElement = document.createElement('button');
  deleteButtonElement.innerText = 'delete';
  deleteButtonElement.className = 'item-delete-button';

  deleteButtonElement.onclick = function () {
    if (editMode) {
      alert('cant delete while in edit mode');
      return;
    }

    var item = document.getElementById(itemID);
    var list = document.getElementById('list'); // remove from display

    list.removeChild(item); // remove from item storage

    storage.remove(itemID);
  }; // append the buttons to container


  itemButtonsElement.appendChild(editButtonElement);
  itemButtonsElement.appendChild(deleteButtonElement);
  return itemButtonsElement;
}

function createItemTextElement(itemID, title, content) {
  var itemTextElement = document.createElement('div');
  itemTextElement.className = 'todo-item-text'; // item title

  var titleElement = document.createElement('div');
  titleElement.innerText = title;
  titleElement.className = 'todo-item-title';
  titleElement.id = 'title' + itemID; // item content

  var contentElement = document.createElement('div');
  contentElement.innerText = content;
  contentElement.className = 'todo-item-content';
  contentElement.id = 'content' + itemID; // append text to parent container 

  itemTextElement.appendChild(titleElement);
  itemTextElement.appendChild(contentElement);
  return itemTextElement;
}

function showItemsFromLocalStorage() {
  var todoMap = storage.getAll();
  var list = document.getElementById('list');

  for (var key in todoMap) {
    var item = todoMap[key];
    var title = item['title'];
    var content = item['content'];
    var itemElement = createTodoItemElement(key, title, content);
    list.appendChild(itemElement);
  }
}

window.onload = function () {
  // attach functions to menu buttons
  document.getElementById('menu').addEventListener('keyup', function (event) {
    if (event.keyCode === 13) {
      document.getElementById('apply-button').click();
      document.getElementById('title-input').focus();
    }
  });
  document.getElementById('clear-button').onclick = clearMenu;
  document.getElementById('apply-button').onclick = menuButtonClick;
  document.getElementById('cancel-button').onclick = cancelEdit;
  document.getElementById('add-button').onclick = addButton;
  document.getElementById('clean-button').onclick = deleteCheckedItems;
  showItemsFromLocalStorage();
};
})();

/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UUFBSUEsS0FBSyxDQUFDQyxPQUFOLEtBQWtCLEVBQXRCLEVBQTBCO0FBQ3RCaEYsTUFBQUEsUUFBUSxDQUFDQyxjQUFULENBQXdCLGNBQXhCLEVBQXdDZ0YsS0FBeEM7QUFDQWpGLE1BQUFBLFFBQVEsQ0FBQ0MsY0FBVCxDQUF3QixhQUF4QixFQUF1QzJELEtBQXZDO0FBQ0g7QUFDSixHQUxEO0FBTUE1RCxFQUFBQSxRQUFRLENBQUNDLGNBQVQsQ0FBd0IsY0FBeEIsRUFBd0NzRSxPQUF4QyxHQUFrRHpCLFNBQWxEO0FBQ0E5QyxFQUFBQSxRQUFRLENBQUNDLGNBQVQsQ0FBd0IsY0FBeEIsRUFBd0NzRSxPQUF4QyxHQUFrRGIsZUFBbEQ7QUFDQTFELEVBQUFBLFFBQVEsQ0FBQ0MsY0FBVCxDQUF3QixlQUF4QixFQUF5Q3NFLE9BQXpDLEdBQW1EZixVQUFuRDtBQUNBeEQsRUFBQUEsUUFBUSxDQUFDQyxjQUFULENBQXdCLFlBQXhCLEVBQXNDc0UsT0FBdEMsR0FBZ0RaLFNBQWhEO0FBQ0EzRCxFQUFBQSxRQUFRLENBQUNDLGNBQVQsQ0FBd0IsY0FBeEIsRUFBd0NzRSxPQUF4QyxHQUFrRHhCLGtCQUFsRDtBQUVBNEIsRUFBQUEseUJBQXlCO0FBQzVCLENBZkQsQyIsInNvdXJjZXMiOlsid2VicGFjazovLzItd2VicGFjay8uL3NyYy9tb2R1bGVzL2hlbHBlci1mdW5jdGlvbnMuanMiLCJ3ZWJwYWNrOi8vMi13ZWJwYWNrLy4vc3JjL21vZHVsZXMvc3RvcmFnZS5qcyIsIndlYnBhY2s6Ly8yLXdlYnBhY2svd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vMi13ZWJwYWNrLy4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIGdldFZhbHVlKGlkKXtcbiAgICByZXR1cm4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpLnZhbHVlXG59XG5mdW5jdGlvbiBzZXRWYWx1ZShpZCx2YWx1ZSl7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpLnZhbHVlID0gdmFsdWVcbn1cbmZ1bmN0aW9uIGdldElubmVyVGV4dChpZCl7XG4gICAgcmV0dXJuIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKS5pbm5lclRleHRcbn1cbmZ1bmN0aW9uIHNldElubmVyVGV4dChpZCx0ZXh0KXtcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCkuaW5uZXJUZXh0ID0gdGV4dFxufVxubW9kdWxlLmV4cG9ydHMgPXtcbiAgICAnZ2V0VmFsdWUnOmdldFZhbHVlLFxuICAgICdzZXRWYWx1ZSc6c2V0VmFsdWUsXG4gICAgJ2dldElubmVyVGV4dCc6Z2V0SW5uZXJUZXh0LFxuICAgICdzZXRJbm5lclRleHQnOnNldElubmVyVGV4dFxufVxuIiwiY29uc3QgVE9ET0xpc3QgPSAnVE9ETy1MaXN0J1xuZnVuY3Rpb24gc3RhcnQoKXtcbiAgICAvL3NldCBhbiBlbXB0eSBtYXAgaWYgbm90LWV4aXN0ZW50XG4gICAgaWYobG9jYWxTdG9yYWdlLmdldEl0ZW0oVE9ET0xpc3QpPT1udWxsKXtcbiAgICAgICAgY29uc3QgdG9kb01hcCA9IEpTT04uc3RyaW5naWZ5KHt9KVxuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShUT0RPTGlzdCx0b2RvTWFwKVxuICAgIH1cbn1cbmZ1bmN0aW9uIHNldEl0ZW1Ub0xvY2Fsc3RvcmFnZShpZCwgdGl0bGUsIGNvbnRlbnQpe1xuICAgIHN0YXJ0KClcbiAgICBjb25zdCBpdGVtID0ge1xuICAgICAgICBcInRpdGxlXCI6IHRpdGxlLFxuICAgICAgICBcImNvbnRlbnRcIjogY29udGVudFxuICAgIH1cbiAgICBjb25zdCB0b2RvTGlzdFN0cmluZyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFRPRE9MaXN0KVxuICAgIGNvbnN0IHRvZG9NYXAgPSBKU09OLnBhcnNlKHRvZG9MaXN0U3RyaW5nKVxuICAgIC8vaW5zZXQgaXRlbSB0byB0b2RvIG1hcFxuICAgIHRvZG9NYXBbaWRdPWl0ZW1cbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShUT0RPTGlzdCxKU09OLnN0cmluZ2lmeSh0b2RvTWFwKSlcbn1cbmZ1bmN0aW9uIHJlbW92ZUl0ZW1Gcm9tTG9jYWxzdG9yYWdlKGlkKXtcbiAgICBzdGFydCgpXG4gICAgY29uc3QgdG9kb0xpc3RTdHJpbmcgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShUT0RPTGlzdClcbiAgICBjb25zdCB0b2RvTWFwID0gSlNPTi5wYXJzZSh0b2RvTGlzdFN0cmluZylcbiAgICAvL2RlbGV0ZSBpdGVtIHRvIHRvZG8gbWFwXG4gICAgZGVsZXRlIHRvZG9NYXBbaWRdXG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oVE9ET0xpc3QsSlNPTi5zdHJpbmdpZnkodG9kb01hcCkpXG59XG5mdW5jdGlvbiBnZXRBbGxJdGVtc0Zyb21TdG9yYWdlKCl7XG4gICAgc3RhcnQoKVxuICAgIHJldHVybiBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFRPRE9MaXN0KSlcbn1cbmZ1bmN0aW9uIGdldEl0ZW1Gcm9tTG9jYWxzdG9yYWdlKGlkKXtcbiAgICBzdGFydCgpXG4gICAgY29uc3QgdG9kb0xpc3RTdHJpbmcgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShUT0RPTGlzdClcbiAgICBjb25zdCB0b2RvTWFwID0gSlNPTi5wYXJzZSh0b2RvTGlzdFN0cmluZylcbiAgICByZXR1cm4gdG9kb01hcFtrZXldXG59XG5mdW5jdGlvbiBjbGVhckl0ZW1zRnJvbUl0ZW1MaXN0KCl7XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oVE9ET0xpc3Qse30pXG59XG5mdW5jdGlvbiBjbGVhclRPRE9MaXN0RnJvbVN0b3JhZ2UoKXtcbiAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShUT0RPTGlzdClcbn1cbm1vZHVsZS5leHBvcnRzID17XG4gICAgJ3NldCc6c2V0SXRlbVRvTG9jYWxzdG9yYWdlLFxuICAgICdnZXQnOmdldEl0ZW1Gcm9tTG9jYWxzdG9yYWdlLFxuICAgICdnZXRBbGwnOmdldEFsbEl0ZW1zRnJvbVN0b3JhZ2UsXG4gICAgJ3JlbW92ZSc6cmVtb3ZlSXRlbUZyb21Mb2NhbHN0b3JhZ2UsXG4gICAgJ2NsZWFyJzogY2xlYXJJdGVtc0Zyb21JdGVtTGlzdCxcbiAgICAnY2xlYXJTdG9yYWdlJzpjbGVhclRPRE9MaXN0RnJvbVN0b3JhZ2Vcbn0iLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiY29uc3Qgc3RvcmFnZSA9IHJlcXVpcmUoJy4vbW9kdWxlcy9zdG9yYWdlLmpzJylcbmNvbnN0IHtnZXRWYWx1ZSxzZXRWYWx1ZSxnZXRJbm5lclRleHQsc2V0SW5uZXJUZXh0fSA9IHJlcXVpcmUoJy4vbW9kdWxlcy9oZWxwZXItZnVuY3Rpb25zLmpzJylcblxubGV0IGVkaXRlZElEID0gMDtcbmxldCBlZGl0TW9kZSA9IGZhbHNlO1xuXG5mdW5jdGlvbiBnZXROZXdJRCgpe1xuICAgIHJldHVybiBuZXcgRGF0ZSgpLmdldFRpbWUoKS50b1N0cmluZygpXG59XG5mdW5jdGlvbiBhZGRJdGVtKCl7XG4gICAgY29uc3QgdGl0bGUgPSBnZXRWYWx1ZSgndGl0bGUtaW5wdXQnKVxuICAgIGlmICh0aXRsZSA9PSAnJyl7XG4gICAgICAgIGFsZXJ0KCdjYW50IGFkZCBhbiBpdGVtIHdpdGhvdXQgYSB0aXRsZScpXG4gICAgICAgIHJldHVyblxuICAgIH1cbiAgICBpZiAoZWRpdE1vZGUpe1xuICAgICAgICBhbGVydCgnY2FudCBhZGQgYW4gaXRlbSB3aGlsZSBpbiBlZGl0IG1vZGUnKVxuICAgICAgICByZXR1cm5cbiAgICB9XG4gICAgY29uc3QgY29udGVudCA9IGdldFZhbHVlKCdjb250ZW50LWlucHV0JylcbiAgICBjb25zdCBsaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xpc3QnKVxuICAgIGNvbnN0IGlkID0gZ2V0TmV3SUQoKVxuICAgIHN0b3JhZ2Uuc2V0KGlkLCB0aXRsZSxjb250ZW50KVxuICAgIGNvbnN0IGl0ZW1FbGVtZW50ID0gY3JlYXRlVG9kb0l0ZW1FbGVtZW50KGlkLHRpdGxlLGNvbnRlbnQpXG4gICAgbGlzdC5hcHBlbmRDaGlsZChpdGVtRWxlbWVudClcbiAgICAvLyByZXNldCBtZW51IGRpc3BsYXlcbiAgICBjbGVhck1lbnUoKVxuICAgIHNldElubmVyVGV4dCgnYXBwbHktYnV0dG9uJywnQWRkJylcbn1cbmZ1bmN0aW9uIGRlbGV0ZUNoZWNrZWRJdGVtcygpe1xuICAgIGNvbnN0IGl0ZW1MaXN0ID0gc3RvcmFnZS5nZXRBbGwoKVxuICAgIGNvbnN0IGxpc3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGlzdCcpXG4gICAgZm9yIChjb25zdCBpZCBpbiBpdGVtTGlzdCkge1xuICAgICAgICBjb25zdCBjaGVja2JveCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBpdGVtLWNoZWNrYm94JHtpZH1gKVxuICAgICAgICBpZihjaGVja2JveC5jaGVja2VkKXtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGlkLCAnaXMgY2hlY2tlZCcpXG4gICAgICAgICAgICBjb25zdCBpdGVtRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGAke2lkfWApXG4gICAgICAgICAgICBsaXN0LnJlbW92ZUNoaWxkKGl0ZW1FbGVtZW50KVxuICAgICAgICAgICAgc3RvcmFnZS5yZW1vdmUoaWQpXG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiBjYW5jZWxFZGl0KCl7XG4gICAgY2xlYXJNZW51KClcbiAgICBlZGl0TW9kZSA9IGZhbHNlXG4gICAgc2V0SW5uZXJUZXh0KCdhcHBseS1idXR0b24nLCdBZGQnKVxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW5jZWwtYnV0dG9uJykuaGlkZGVuID0gdHJ1ZVxuICAgIGVkaXRlZElEID0gMCAgXG59XG5cbmZ1bmN0aW9uIGNsZWFyTWVudSgpe1xuICAgIHNldFZhbHVlKCd0aXRsZS1pbnB1dCcsJycpXG4gICAgc2V0VmFsdWUoJ2NvbnRlbnQtaW5wdXQnLCcnKVxufVxuXG5mdW5jdGlvbiBtZW51QnV0dG9uQ2xpY2soKXtcbiAgICBpZighZWRpdE1vZGUpe1xuICAgICAgICAvLyBhZGRpbmcgYSBuZXcgaXRlbVxuICAgICAgICBhZGRJdGVtKClcbiAgICB9ZWxzZXtcbiAgICAgICAgLy8gZWRpdGluZyBhbiBleGlzdGluZyBpdGVtXG4gICAgICAgIGlmIChnZXRWYWx1ZSgndGl0bGUtaW5wdXQnKT09Jycpe1xuICAgICAgICAgICAgYWxlcnQoJ2NhbnQgc2V0IGFuIGVtcHR5IHRpdGxlJylcbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHRpdGxlID0gZ2V0VmFsdWUoJ3RpdGxlLWlucHV0JylcbiAgICAgICAgY29uc3QgY29udGVudCA9IGdldFZhbHVlKCdjb250ZW50LWlucHV0JylcbiAgICAgICAgc2V0SW5uZXJUZXh0KGB0aXRsZSR7ZWRpdGVkSUR9YCx0aXRsZSlcbiAgICAgICAgc2V0SW5uZXJUZXh0KGBjb250ZW50JHtlZGl0ZWRJRH1gLGNvbnRlbnQpXG4gICAgICAgIHN0b3JhZ2Uuc2V0KGVkaXRlZElELCB0aXRsZSwgY29udGVudClcbiAgICAgICAgY2xlYXJNZW51KClcbiAgICAgICAgZWRpdE1vZGUgPSBmYWxzZVxuICAgICAgICBzZXRJbm5lclRleHQoJ2FwcGx5LWJ1dHRvbicsJ0FkZCcpXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW5jZWwtYnV0dG9uJykuaGlkZGVuID0gdHJ1ZVxuICAgICAgICBlZGl0ZWRJRCA9IDBcbiAgICB9XG59XG5mdW5jdGlvbiBhZGRCdXR0b24oKXtcbiAgICBjbGVhck1lbnUoKVxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0aXRsZS1pbnB1dCcpLmZvY3VzKClcbn1cblxuZnVuY3Rpb24gY3JlYXRlVG9kb0l0ZW1FbGVtZW50KGl0ZW1JRCx0aXRsZSxjb250ZW50KXtcbiAgICAvLyBvbCB0b2RvLWl0ZW1cbiAgICBjb25zdCBpdGVtRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29sJylcbiAgICBpdGVtRWxlbWVudC5jbGFzc05hbWUgPSAndG9kby1pdGVtJ1xuICAgIGl0ZW1FbGVtZW50LmlkID0gaXRlbUlEO1xuICAgIC8vIGlucHV0IGNoZWNrYm94XG4gICAgY29uc3QgaXRlbUNoZWNrYm94RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0JylcbiAgICBpdGVtQ2hlY2tib3hFbGVtZW50LnR5cGUgPSAnY2hlY2tib3gnXG4gICAgaXRlbUNoZWNrYm94RWxlbWVudC5jbGFzc05hbWUgPSAnaXRlbS1jaGVja2JveCdcbiAgICBpdGVtQ2hlY2tib3hFbGVtZW50LmlkID0gYGl0ZW0tY2hlY2tib3gke2l0ZW1JRH1gXG4gICAgLy8gZGl2IHRvZG8taXRlbS10ZXh0XG4gICAgY29uc3QgaXRlbVRleHRFbGVtZW50ID0gY3JlYXRlSXRlbVRleHRFbGVtZW50KGl0ZW1JRCx0aXRsZSxjb250ZW50KVxuICAgIGNvbnN0IGl0ZW1CdXR0b25zRWxlbWVudCA9IGNyZWF0ZUl0ZW1CdXR0b25zRWxlbWVudChpdGVtSUQpXG4gICAgLy8gYXBwZW5kIGNoZWNrYm94LCB0ZXh0IGFuZCBidXR0b25zIHRvIGxpc3QtaXRlbVxuICAgIGl0ZW1FbGVtZW50LmFwcGVuZENoaWxkKGl0ZW1DaGVja2JveEVsZW1lbnQpXG4gICAgaXRlbUVsZW1lbnQuYXBwZW5kQ2hpbGQoaXRlbVRleHRFbGVtZW50KVxuICAgIGl0ZW1FbGVtZW50LmFwcGVuZENoaWxkKGl0ZW1CdXR0b25zRWxlbWVudClcblxuICAgIHJldHVybiBpdGVtRWxlbWVudFxufVxuZnVuY3Rpb24gY3JlYXRlSXRlbUJ1dHRvbnNFbGVtZW50KGl0ZW1JRCl7XG5cbiAgICBjb25zdCBpdGVtQnV0dG9uc0VsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIGl0ZW1CdXR0b25zRWxlbWVudC5jbGFzc05hbWUgPSAndG9kby1pdGVtLWJ1dHRvbnMnXG4gICAgLy8gYnV0dG9uIGVkaXRcbiAgICBjb25zdCBlZGl0QnV0dG9uRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpXG4gICAgZWRpdEJ1dHRvbkVsZW1lbnQuaW5uZXJUZXh0ID0gJ2VkaXQnXG4gICAgZWRpdEJ1dHRvbkVsZW1lbnQuY2xhc3NOYW1lID0gJ2l0ZW0tZWRpdC1idXR0b24nXG4gICAgZWRpdEJ1dHRvbkVsZW1lbnQub25jbGljayA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIC8vIHNldCBtZW51IHRvIGVkaXRpbmcgc3RhdGVcbiAgICAgICAgZWRpdE1vZGUgPSB0cnVlXG4gICAgICAgIGVkaXRlZElEID0gaXRlbUlEXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW5jZWwtYnV0dG9uJykuaGlkZGVuID0gZmFsc2VcbiAgICAgICAgc2V0SW5uZXJUZXh0KCdhcHBseS1idXR0b24nLCdBcHBseScpXG4gICAgICAgIGNvbnN0IHRpdGxlID0gZ2V0SW5uZXJUZXh0KGB0aXRsZSR7aXRlbUlEfWApXG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSBnZXRJbm5lclRleHQoYGNvbnRlbnQke2l0ZW1JRH1gKVxuICAgICAgICBzZXRWYWx1ZSgndGl0bGUtaW5wdXQnLHRpdGxlKVxuICAgICAgICBzZXRWYWx1ZSgnY29udGVudC1pbnB1dCcsY29udGVudClcbiAgICB9XG4gICAgLy8gYnV0dG9uIGRlbGV0ZVxuICAgIGNvbnN0IGRlbGV0ZUJ1dHRvbkVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKVxuICAgIGRlbGV0ZUJ1dHRvbkVsZW1lbnQuaW5uZXJUZXh0ID0gJ2RlbGV0ZSdcbiAgICBkZWxldGVCdXR0b25FbGVtZW50LmNsYXNzTmFtZSA9ICdpdGVtLWRlbGV0ZS1idXR0b24nXG4gICAgZGVsZXRlQnV0dG9uRWxlbWVudC5vbmNsaWNrID0gZnVuY3Rpb24oKXtcbiAgICAgICAgaWYoZWRpdE1vZGUpe1xuICAgICAgICAgICAgYWxlcnQoJ2NhbnQgZGVsZXRlIHdoaWxlIGluIGVkaXQgbW9kZScpXG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgfVxuICAgICAgICBjb25zdCBpdGVtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaXRlbUlEKVxuICAgICAgICBjb25zdCBsaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xpc3QnKVxuICAgICAgICAvLyByZW1vdmUgZnJvbSBkaXNwbGF5XG4gICAgICAgIGxpc3QucmVtb3ZlQ2hpbGQoaXRlbSlcbiAgICAgICAgLy8gcmVtb3ZlIGZyb20gaXRlbSBzdG9yYWdlXG4gICAgICAgIHN0b3JhZ2UucmVtb3ZlKGl0ZW1JRClcbiAgICB9XG4gICAgLy8gYXBwZW5kIHRoZSBidXR0b25zIHRvIGNvbnRhaW5lclxuICAgIGl0ZW1CdXR0b25zRWxlbWVudC5hcHBlbmRDaGlsZChlZGl0QnV0dG9uRWxlbWVudClcbiAgICBpdGVtQnV0dG9uc0VsZW1lbnQuYXBwZW5kQ2hpbGQoZGVsZXRlQnV0dG9uRWxlbWVudClcblxuICAgIHJldHVybiBpdGVtQnV0dG9uc0VsZW1lbnRcbn1cbmZ1bmN0aW9uIGNyZWF0ZUl0ZW1UZXh0RWxlbWVudChpdGVtSUQsdGl0bGUsY29udGVudCl7XG5cbiAgICBjb25zdCBpdGVtVGV4dEVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIGl0ZW1UZXh0RWxlbWVudC5jbGFzc05hbWUgPSAndG9kby1pdGVtLXRleHQnXG4gICAgLy8gaXRlbSB0aXRsZVxuICAgIGNvbnN0IHRpdGxlRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgdGl0bGVFbGVtZW50LmlubmVyVGV4dCA9IHRpdGxlXG4gICAgdGl0bGVFbGVtZW50LmNsYXNzTmFtZSA9ICd0b2RvLWl0ZW0tdGl0bGUnXG4gICAgdGl0bGVFbGVtZW50LmlkID0gJ3RpdGxlJytpdGVtSURcbiAgICAvLyBpdGVtIGNvbnRlbnRcbiAgICBjb25zdCBjb250ZW50RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgY29udGVudEVsZW1lbnQuaW5uZXJUZXh0ID0gY29udGVudFxuICAgIGNvbnRlbnRFbGVtZW50LmNsYXNzTmFtZSA9ICd0b2RvLWl0ZW0tY29udGVudCdcbiAgICBjb250ZW50RWxlbWVudC5pZCA9ICdjb250ZW50JytpdGVtSURcbiAgICAvLyBhcHBlbmQgdGV4dCB0byBwYXJlbnQgY29udGFpbmVyIFxuICAgIGl0ZW1UZXh0RWxlbWVudC5hcHBlbmRDaGlsZCh0aXRsZUVsZW1lbnQpXG4gICAgaXRlbVRleHRFbGVtZW50LmFwcGVuZENoaWxkKGNvbnRlbnRFbGVtZW50KVxuXG4gICAgcmV0dXJuIGl0ZW1UZXh0RWxlbWVudFxufVxuZnVuY3Rpb24gc2hvd0l0ZW1zRnJvbUxvY2FsU3RvcmFnZSgpe1xuICAgIGNvbnN0IHRvZG9NYXAgPSBzdG9yYWdlLmdldEFsbCgpXG4gICAgY29uc3QgbGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsaXN0JylcbiAgICBmb3IgKGNvbnN0IGtleSBpbiB0b2RvTWFwKSB7XG4gICAgICAgIGNvbnN0IGl0ZW0gPSB0b2RvTWFwW2tleV1cbiAgICAgICAgY29uc3QgdGl0bGUgPSBpdGVtWyd0aXRsZSddXG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSBpdGVtWydjb250ZW50J11cbiAgICAgICAgY29uc3QgaXRlbUVsZW1lbnQgPSBjcmVhdGVUb2RvSXRlbUVsZW1lbnQoa2V5LHRpdGxlLGNvbnRlbnQpXG4gICAgICAgIGxpc3QuYXBwZW5kQ2hpbGQoaXRlbUVsZW1lbnQpXG4gICAgfVxufVxud2luZG93Lm9ubG9hZCA9IGZ1bmN0aW9uKCl7XG4gICAgLy8gYXR0YWNoIGZ1bmN0aW9ucyB0byBtZW51IGJ1dHRvbnNcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWVudScpLmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgaWYgKGV2ZW50LmtleUNvZGUgPT09IDEzKSB7XG4gICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXBwbHktYnV0dG9uJykuY2xpY2soKVxuICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RpdGxlLWlucHV0JykuZm9jdXMoKVxuICAgICAgICB9XG4gICAgfSlcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2xlYXItYnV0dG9uJykub25jbGljayA9IGNsZWFyTWVudVxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhcHBseS1idXR0b24nKS5vbmNsaWNrID0gbWVudUJ1dHRvbkNsaWNrXG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbmNlbC1idXR0b24nKS5vbmNsaWNrID0gY2FuY2VsRWRpdFxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhZGQtYnV0dG9uJykub25jbGljayA9IGFkZEJ1dHRvblxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjbGVhbi1idXR0b24nKS5vbmNsaWNrID0gZGVsZXRlQ2hlY2tlZEl0ZW1zXG4gICAgXG4gICAgc2hvd0l0ZW1zRnJvbUxvY2FsU3RvcmFnZSgpXG59XG4iXSwibmFtZXMiOlsiZ2V0VmFsdWUiLCJpZCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJ2YWx1ZSIsInNldFZhbHVlIiwiZ2V0SW5uZXJUZXh0IiwiaW5uZXJUZXh0Iiwic2V0SW5uZXJUZXh0IiwidGV4dCIsIm1vZHVsZSIsImV4cG9ydHMiLCJUT0RPTGlzdCIsInN0YXJ0IiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsInRvZG9NYXAiLCJKU09OIiwic3RyaW5naWZ5Iiwic2V0SXRlbSIsInNldEl0ZW1Ub0xvY2Fsc3RvcmFnZSIsInRpdGxlIiwiY29udGVudCIsIml0ZW0iLCJ0b2RvTGlzdFN0cmluZyIsInBhcnNlIiwicmVtb3ZlSXRlbUZyb21Mb2NhbHN0b3JhZ2UiLCJnZXRBbGxJdGVtc0Zyb21TdG9yYWdlIiwiZ2V0SXRlbUZyb21Mb2NhbHN0b3JhZ2UiLCJrZXkiLCJjbGVhckl0ZW1zRnJvbUl0ZW1MaXN0IiwiY2xlYXJUT0RPTGlzdEZyb21TdG9yYWdlIiwicmVtb3ZlSXRlbSIsInN0b3JhZ2UiLCJyZXF1aXJlIiwiZWRpdGVkSUQiLCJlZGl0TW9kZSIsImdldE5ld0lEIiwiRGF0ZSIsImdldFRpbWUiLCJ0b1N0cmluZyIsImFkZEl0ZW0iLCJhbGVydCIsImxpc3QiLCJzZXQiLCJpdGVtRWxlbWVudCIsImNyZWF0ZVRvZG9JdGVtRWxlbWVudCIsImFwcGVuZENoaWxkIiwiY2xlYXJNZW51IiwiZGVsZXRlQ2hlY2tlZEl0ZW1zIiwiaXRlbUxpc3QiLCJnZXRBbGwiLCJjaGVja2JveCIsImNoZWNrZWQiLCJjb25zb2xlIiwibG9nIiwicmVtb3ZlQ2hpbGQiLCJyZW1vdmUiLCJjYW5jZWxFZGl0IiwiaGlkZGVuIiwibWVudUJ1dHRvbkNsaWNrIiwiYWRkQnV0dG9uIiwiZm9jdXMiLCJpdGVtSUQiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NOYW1lIiwiaXRlbUNoZWNrYm94RWxlbWVudCIsInR5cGUiLCJpdGVtVGV4dEVsZW1lbnQiLCJjcmVhdGVJdGVtVGV4dEVsZW1lbnQiLCJpdGVtQnV0dG9uc0VsZW1lbnQiLCJjcmVhdGVJdGVtQnV0dG9uc0VsZW1lbnQiLCJlZGl0QnV0dG9uRWxlbWVudCIsIm9uY2xpY2siLCJkZWxldGVCdXR0b25FbGVtZW50IiwidGl0bGVFbGVtZW50IiwiY29udGVudEVsZW1lbnQiLCJzaG93SXRlbXNGcm9tTG9jYWxTdG9yYWdlIiwid2luZG93Iiwib25sb2FkIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50Iiwia2V5Q29kZSIsImNsaWNrIl0sInNvdXJjZVJvb3QiOiIifQ==